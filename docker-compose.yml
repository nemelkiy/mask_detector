version: "3"

services:
    mask_detector:
      build: docker/php
      container_name: mask_detector
      volumes:
        - ./:/app
        - ./docker/php/php.ini:/usr/local/etc/php/php.ini

    nginx:
          image: nginx
          container_name: nginx
          ports:
            - $NGINX_PUBLIC_PORT:80
          volumes:
            - ./:/app
            - ./docker/nginx/default.conf:/etc/nginx/conf.d/default.conf
          depends_on:
            - mask_detector

#    gstreamer:
#      build: docker/gstreamer
#      container_name: gstreamer

    rabbitmq:
      image: "rabbitmq:3-management"
      hostname: "rabbit1"
      environment:
        RABBITMQ_ERLANG_COOKIE: "SWQOKODSQALRPCLNMEQG"
        RABBITMQ_DEFAULT_USER: ${RABBITMQ_DEFAULT_USER}
        RABBITMQ_DEFAULT_PASS: ${RABBITMQ_DEFAULT_PASS}
        RABBITMQ_DEFAULT_VHOST: "/"
      labels:
        NAME: "rabbitmq1"
      volumes:
        - "./docker/rabbitmq/enabled_plugins:/etc/rabbitmq/enabled_plugins"
      ports:
        - $RABBITMQ_PUBLIC_PORT:5672
        - $RABBITMQ_UI_PUBLIC_PORT:15672